# Smart-EMAP (ERP+APS+MES) 統合管理システム

製造業のデジタルトランスフォーメーションを実現するための、次世代統合管理システムです。ERPによる経営資源の最適化、APSによる高精度な生産計画、MESによる現場の実行と可視化をシームレスに連携させ、設計から製造、出荷まで一気通貫のデータフローを構築します。

## 技術スタック

### 🖥️ フロントエンド技術スタック

- **フレームワーク**: Vue.js 3 (Composition API)
- **言語**: TypeScript
- **ビルドツール**: Vite
- **状態管理**: Pinia (永続化対応)
- **ルーティング**: Vue Router 4
- **UIコンポーネントライブラリ**: Element Plus

### ⚙️ バックエンド技術スタック

- **言語**: Python 3.14
- **核心框架**: FastAPI
- **非同期処理**: asyncio, aiohttp
- **データベース接続**: aiomysql, SQLAlchemy 2.0+

### 🗄️ データベースとストレージ

- **メインデータベース**: MySQL 8.0+
- **データモデル**: SQLAlchemy ORM
- **マイグレーション**: Alembic

## プロジェクト構造

本プロジェクトは、機能モジュールごとに整理された構造を持っています。詳細は [docs/PROJECT_STRUCTURE.md](docs/PROJECT_STRUCTURE.md) を参照してください。

```
Smart-EMAPs/
├── backend/                    # バックエンド（FastAPI + Python）
│   ├── app/
│   │   ├── core/              # コア機能（設定、データベース、セキュリティ）
│   │   ├── modules/           # 機能モジュール
│   │   │   ├── auth/          # 認証モジュール
│   │   │   ├── erp/           # ERPモジュール
│   │   │   ├── aps/           # APSモジュール
│   │   │   ├── mes/           # MESモジュール
│   │   │   └── websocket/     # WebSocketモジュール
│   │   └── main.py            # アプリケーションエントリーポイント
│   ├── database/              # データベース初期化スクリプト
│   └── requirements.txt       # Python依存関係
│
├── frontend/                   # フロントエンド（Vue.js 3 + TypeScript）
│   └── src/
│       ├── modules/           # 機能モジュール
│       │   ├── auth/          # 認証モジュール（API、ストア、ビュー）
│       │   ├── erp/           # ERPモジュール
│       │   ├── aps/           # APSモジュール
│       │   ├── mes/           # MESモジュール
│       │   └── websocket/     # WebSocketモジュール
│       ├── shared/            # 共有機能（API、ルーター）
│       ├── views/             # 共通ビュー（Dashboard、Home）
│       └── main.ts            # アプリケーションエントリーポイント
│
├── docs/                       # ドキュメント
│   ├── PROJECT_STRUCTURE.md   # プロジェクト構造の詳細説明
│   └── WEBSOCKET_IMPLEMENTATION.md
│
├── logs/                       # ログファイル
├── start.py                    # 起動スクリプト
└── README.md                   # プロジェクト説明書
```

## 主な機能

本システムは、以下の主要な機能モジュールを提供します。

### ERP（企業資源計画）- 経営の神経中枢

経営判断に必要な情報を一元管理し、全部門の業務効率を最大化します。

#### 販売管理

- 顧客管理 (CRM)
- 見積管理
- 受注管理
- 出荷・納品管理
- 売上・請求管理
- 売掛金管理

#### 購買管理

- 仕入先管理
- 発注依頼・承認ワークフロー
- 発注管理
- 入荷・検収管理
- 買掛金管理

#### 在庫管理

- マスタデータ管理
- ロケーション管理（倉庫、棚）
- ロット別・シリアル番号別在庫追跡
- 入出庫管理
- 棚卸管理
- 適正在庫分析・発注点管理

#### 会計管理

- 原価管理（標準原価・実際原価・原価差異分析）
- 総勘定元帳 (GL)
- 財務諸表（B/S, P/L, C/F）

#### 人事・労務管理

- 従業員マスタ
- スキルマップ管理（作業者の資格・スキルをAPS/MESと連携）

### APS（先進的計画・スケジューリング）- 最適化の司令塔

複雑な制約条件を考慮し、製造リードタイムの短縮と設備稼働率の向上を実現する高精度な計画を立案します。

#### マスタ管理

- リソース管理（設備、作業者、金型、治具）
- カレンダー管理（稼働日、シフト、休憩時間、保守計画）
- 部品表（BOM） - 多階層に対応
- 工順（Routing）管理 - 標準時間（段取、加工）、代替工順

#### 計画立案

- 需要予測
- 生産計画（大日程計画） - 長期的な需要と生産能力を評価
- 資材所要量計画（MRP） - 生産計画に基づき、必要な資材の量とタイミングを算出
- 生産能力計画（CRP） - 各工程の負荷を評価し、能力のボトルネックを特定

#### スケジューリング

- 有限能力スケジューリング（FCS） - リソースの制約を考慮した詳細なスケジュールを作成
- 最適化エンジン（納期遵守、段取時間最小化、スループット最大化など、目的に応じたルール設定）
- シミュレーション機能（What-if分析） - 特急オーダーや設備故障時の影響を事前評価

### MES（製造実行システム）- 現場の神経系

計画と実行の乖離をなくし、リアルタイムな情報収集によって品質・生産性の向上とトレーサビリティを確立します。

#### 製造実行管理

- 作業指示（スケジューリング結果を指示書として現場に配信）
- 作業実績管理（開始・終了、作業者、実績数量、不良情報をリアルタイムに収集）
- 進捗管理と可視化（生産監視ボード、アンドン）

#### 品質管理

- 品質検査（受入検査、工程内検査、出荷検査）
- 仕様・検査基準管理
- 不適合品管理と分析 (SPC)

#### 在庫・物流管理

- 仕掛品（WIP）管理
- 工場内物流指示（部材の工程間搬送指示）
- 製品トレースビリティ（正逆） - ロット番号から使用部品や工程履歴を追跡

#### 設備・リソース管理

- 設備保全（予防保全、予知保全、事後保全の計画と実績）
- 設備稼働監視（OEE分析） - 設備のパフォーマンスをリアルタイムで分析
- 作業者管理（出退勤、スキルに基づく作業割り当て）

#### ドキュメント管理

- 標準作業手順書（SOP）や図面の電子配信

## システム間連携 - データの流れ

この統合システムの真価は、各モジュール間のシームレスなデータ連携にあります。

### 計画の連鎖 (ERP → APS → MES)

ERPで受注情報が登録されると、その情報がAPSに連携され、生産計画とスケジューリングの対象となります。

APSで最適化された詳細スケジュール（いつ、どの設備で、何を、何個作るか）がMESに作業指示として配信されます。

### 実績のフィードバック (MES → APS & ERP)

MESは現場での作業実績（進捗、良品数、不良数、設備停止など）をリアルタイムに収集します。

この実績データはAPSにフィードバックされ、計画と実績の差異を分析。予期せぬ問題が発生した際には、APSが即座に再スケジューリングを行い、影響を最小限に抑えます。

同時に、生産実績、材料消費、作業時間などのデータはERPに連携され、正確な在庫更新と実際原価計算に使用されます。

## 詳細機能

### 📊 マスターデータ管理

- **部品表 (BOM) 管理**: 製品構成の階層管理、部品の材料構成管理
- **製品マスター**: 製品情報、仕様、価格管理
- **材料マスター**: 材料情報、仕入先、価格、安全在庫管理
- **顧客マスター**: 顧客情報、配送先管理
- **仕入先マスター**: 仕入先情報、能力評価、パフォーマンス管理
- **機械マスター**: 設備情報、稼働状況管理
- **工程マスター**: 製造工程、工程ルート、標準時間管理
- **担当者・部門管理**: 組織構造、権限管理

### 📈 受注管理

- **日次受注管理**: 日別受注データの入力・編集・確認
- **月次受注管理**: 月別受注データの集計・分析
- **顧客別受注履歴**: 顧客ごとの注文履歴追跡
- **配送先別受注履歴**: 配送先ごとの受注状況管理
- **受注KPI分析**: 受注実績の可視化、予測分析
- **受注データ比較**: 期間別受注実績の比較分析

### 🏭 生産管理

- **生産実績管理**: 日次生産実績の入力・集計・分析
- **生産指示管理**: カッティング指示、工程別指示書発行
- **生産計画**: バッチ計画、生産スケジューリング
- **ガントチャート**: 生産進捗の可視化、スケジュール管理
- **工程管理**: 各工程の進捗状況、品質管理
- **生産効率分析**: 設備稼働率、生産性分析

### 📦 在庫管理

- **材料在庫管理**: 材料の入出庫、在庫数量管理
- **製品在庫管理**: 完成品在庫の管理
- **仕掛品在庫管理**: 工程間在庫の追跡
- **在庫価値管理**: 在庫金額の計算・分析
- **棚卸管理**: 定期棚卸作業の支援
- **在庫トレンド分析**: 在庫推移の可視化

### 🚚 出荷管理

- **ピッキング管理**: ピッキングリスト作成、作業進捗管理
- **出荷実績管理**: 出荷データの記録・分析
- **配送管理**: 配送先別出荷状況管理
- **出荷レポート**: 出荷実績の各種レポート生成
- **溶接出荷管理**: 溶接工程専用の出荷管理

### 🔧 外注管理

- **外注受注管理**: 外注先への発注管理
- **外注実績管理**: 外注作業の進捗・品質管理
- **外注コスト管理**: 外注費用の計算・分析
- **外注先評価**: 外注先の能力・品質評価
- **外注在庫管理**: 外注先での仮想在庫管理

### 📊 KPI分析

- **生産性分析**: 設備稼働率、人員効率の分析
- **在庫回転率**: 在庫の回転状況分析
- **受注実績分析**: 受注目標達成率、成長率分析
- **コスト分析**: 材料費、加工費の分析
- **品質分析**: 不良率、品質指標の管理

### ⚙️ システム管理

- **ユーザー管理**: ユーザーアカウント、権限設定
- **ログイン履歴**: アクセスログ、セキュリティ監査
- **システム設定**: 各種システムパラメータの設定
- **データベース管理**: データ整合性チェック、バックアップ

## セットアップ手順

### 前提条件

- Node.js 18.0以上
- Python 3.10以上
- MySQL 8.0以上

### クイックスタート（推奨）

プロジェクトルートで以下のコマンドを実行すると、前后端を同時に起動できます：

**Windows:**
```bash
start.bat
```

**Linux/Mac:**
```bash
chmod +x start.sh
./start.sh
```

**または直接Pythonスクリプトを実行:**
```bash
python start.py
```

このスクリプトは以下を自動的に実行します：
- 環境チェック（Python、Node.js）
- 依存関係の確認とインストール
- バックエンドサーバーの起動（http://localhost:8000）
- フロントエンドサーバーの起動（http://localhost:5000）

### 手動セットアップ

#### フロントエンドセットアップ

```bash
cd frontend
npm install
npm run dev
```

#### バックエンドセットアップ

```bash
cd backend
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
pip install -r requirements.txt
uvicorn app.main:app --reload
```

### データベースの初期化

```bash
# MySQLにログイン
mysql -u root -p

# データベースとユーザーの作成
CREATE DATABASE smart_emap CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE USER 'emap_user'@'localhost' IDENTIFIED BY 'emap_password';
GRANT ALL PRIVILEGES ON smart_emap.* TO 'emap_user'@'localhost';
FLUSH PRIVILEGES;

# 初期化スクリプトの実行
mysql -u emap_user -p smart_emap < backend/database/init/01_init.sql
```

## ライセンス

このプロジェクトは独自のライセンスの下でライセンスされています。

## 開発チーム

Smart-EMAP開発チーム

---

**最終更新日時**: 2026年1月7日（日本時間）

